<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>spatialinfo package &#8212; SpatialInformation 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="spatialinfo" href="modules.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="spatialinfo-package">
<h1>spatialinfo package<a class="headerlink" href="#spatialinfo-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="module-spatialinfo.basis_decoder">
<span id="spatialinfo-basis-decoder-module"></span><h2>spatialinfo.basis_decoder module<a class="headerlink" href="#module-spatialinfo.basis_decoder" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.basis_decoder.fixed_template">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.basis_decoder.</span></span><span class="sig-name descname"><span class="pre">fixed_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_corridors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neurons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.basis_decoder.fixed_template" title="Link to this definition">¶</a></dt>
<dd><p>Implements direct basis decoding with LOOCV using fixed binning.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>dff (pandas.DataFrame): Calcium imaging traces for all neurons.
behavior (pandas.DataFrame): Behavioral data with X (corridor), Y (position).
n_corridors (int): Number of corridors in the setting (default=2).
n_bins (int): Number of spatial bins (default=30).
n_neurons (int): Number of most active neurons to use for decoding (default=5).</p>
</dd>
<dt>Returns:</dt><dd><p>decoded_position (pandas.DataFrame): Decoded X and Y positions.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spatialinfo.decoder">
<span id="spatialinfo-decoder-module"></span><h2>spatialinfo.decoder module<a class="headerlink" href="#module-spatialinfo.decoder" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.decoder.clean_data">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.decoder.</span></span><span class="sig-name descname"><span class="pre">clean_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.decoder.clean_data" title="Link to this definition">¶</a></dt>
<dd><p>Removes large downward jumps in bin values (teleport artifacts).</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>dff (np.ndarray): Feature matrix (time x features).
behavior (np.ndarray): Behavior data (time x behavioral variables), where column 1 contains bin values.</p>
</dd>
<dt>Returns:</dt><dd><p>dff_clean (np.ndarray): Cleaned feature matrix.
behavior_clean (np.ndarray): Cleaned behavior matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.decoder.create_templates">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.decoder.</span></span><span class="sig-name descname"><span class="pre">create_templates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.decoder.create_templates" title="Link to this definition">¶</a></dt>
<dd><p>Averages population activity based on positional information to create templates.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>dff (numpy.ndarray): </dt><dd><p>A 2D array of delta(f)/f calcium traces, with features as columns and timepoints as rows</p>
</dd>
<dt>bh (numpy.ndarray): </dt><dd><p>A 2D array where:
- column 1 contains X
- column 2 contains Y
- column 3 contains trial
- rows are timepoints</p>
</dd>
</dl>
<p>n_bins (int): number of spatial bins to sort the data into.
average (boolean): in case the algorithm yields templates with the same positional ID, return average. Defaults to False.</p>
</dd>
<dt>Returns:</dt><dd><p>templates (numpy.ndarray): each column is one template
positions (numpy.ndarray): column 1: spatial bin, column 2: corridor, row: indicates template column in templates
bins (numpy.ndarray or IntervalIndex): returns the computed bins</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.decoder.mahalanobis">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.decoder.</span></span><span class="sig-name descname"><span class="pre">mahalanobis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.decoder.mahalanobis" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.decoder.match_templates">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.decoder.</span></span><span class="sig-name descname"><span class="pre">match_templates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">templates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_vector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'correlation'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.decoder.match_templates" title="Link to this definition">¶</a></dt>
<dd><p>Decodes the position based on the closest matching template.</p>
<p>This function finds the most similar template to the <cite>input_vector</cite> using the specified 
<cite>distance_metric</cite> and returns the corresponding spatial bin and corridor.</p>
<dl>
<dt>Parameters:</dt><dd><dl class="simple">
<dt>templates (numpy.ndarray): </dt><dd><p>A 2D array where each column represents a different template.</p>
</dd>
<dt>positions (numpy.ndarray): </dt><dd><p>A 1D array where:
- Column 1 contains spatial bin indices.
- Rows correspond to the columns in <cite>templates</cite>.</p>
</dd>
<dt>input_vector (numpy.ndarray): </dt><dd><p>A 1D array representing the input vector to be decoded based on similarity to <cite>templates</cite>.</p>
</dd>
<dt>distance_metric (str, optional): </dt><dd><p>The metric used to determine the closest match. Supported values are:
- “correlation” (default)
- “cosine”
- “euclidean”
- “mahalanobis”</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: (spatial_bin, corridor), where:</dt><dd><ul class="simple">
<li><p>spatial_bin (int): The estimated spatial bin based on the closest template.</p></li>
<li><p>corridor (int): The corresponding corridor.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If an unsupported <cite>distance_metric</cite> is provided.</p>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">templates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 5 templates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_templates</span><span class="p">(</span><span class="n">templates</span><span class="p">,</span> <span class="n">positions</span><span class="p">,</span> <span class="n">input_vector</span><span class="p">,</span> <span class="n">distance_metric</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">)</span>
<span class="go">(3)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spatialinfo.dimensionality_utils">
<span id="spatialinfo-dimensionality-utils-module"></span><h2>spatialinfo.dimensionality_utils module<a class="headerlink" href="#module-spatialinfo.dimensionality_utils" title="Link to this heading">¶</a></h2>
<p>&#64;author: Lukas Anneser</p>
<p>code prototype written by Julio Esparza, 
obtained from <a class="reference external" href="https://github.com/PridaLab/hippocampal_manifolds">https://github.com/PridaLab/hippocampal_manifolds</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.dimensionality_utils.compute_abids">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.dimensionality_utils.</span></span><span class="sig-name descname"><span class="pre">compute_abids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.dimensionality_utils.compute_abids" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Angle-Based Intrinsic Dimensionality (ABID) of a dataset.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><dl class="simple">
<dt>arr (numpy.ndarray):</dt><dd><p>Array of shape (n_samples, n_features) representing the data.</p>
</dd>
<dt>n_neigh (int):</dt><dd><p>Number of nearest neighbors used for computing the structure index.</p>
</dd>
<dt>verbose (bool):</dt><dd><p>Whether to display a progress bar.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>np.ndarray:</dt><dd><p>Estimated intrinsic dimensionality for each point in the dataset.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spatialinfo.spatial_information">
<span id="spatialinfo-spatial-information-module"></span><h2>spatialinfo.spatial_information module<a class="headerlink" href="#module-spatialinfo.spatial_information" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.add_trial_column">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">add_trial_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.add_trial_column" title="Link to this definition">¶</a></dt>
<dd><p>Adds a ‘trial’ column to the behavior DataFrame.</p>
<p>A trial starts when:
1. The animal moves backward (Y-position decreases by being teleported to starting position).
2. The corridor changes (X-position changes).
Trials with fewer than 30 timepoints are merged with the previous trial.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>behavior (DataFrame): Must contain ‘X’ (corridor) and ‘Y’ (position in corridor).</p>
</dd>
<dt>Returns:</dt><dd><p>behavior (DataFrame): Updated DataFrame with a new ‘trial’ column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.avg_activity">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">avg_activity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_per_bin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summed_traces</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.avg_activity" title="Link to this definition">¶</a></dt>
<dd><p>Devides summed neural activity matrix by the occupancy matrix to obtain the average activity in each spatial bin.</p>
<blockquote>
<div><dl class="simple">
<dt>Parameters:</dt><dd><p>time_per_bin (pandas.core_frame.DataFrame): time spent in each bin, n_bins x n_corridors
summed_traces (pandas.core.frame.DataFrame): summed activity for each bin, n_bins x n_corridors x n_neurons</p>
</dd>
<dt>Returns:</dt><dd><p>avg_activity_mtx (pandas.core_frame.DataFrame): average activity in each spatial bin.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.binning">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.binning" title="Link to this definition">¶</a></dt>
<dd><p>Bins occupancy and activity data. Assumes that corridors have been completely sampled by the animal.
Assumes that distinct corridors are characterized by X position.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>dff (pandas.core.frame.DataFrame): df/f calcium imaging data (rows: time; columns: neurons)
behavior (pandas.core.frame.DataFrame): contains X, Y columns with spatial information and frdIn with tail vigor
n_bins (int): number of bins, defaults to 30
n_corr (int): number of corridors, defaults to 2
fps (int): frames per second, defaults to 30
bins (numpy.ndarray): edges for bins can optionally be provided</p>
</dd>
<dt>Returns:</dt><dd><p>time_per_bin (pandas.core.frame.DataFrame): time spent in each bin, n_bins x n_corridors
summed_traces (pandas.core.frame.DataFrame): summed activity for each bin, n_bins x n_corridors x n_neurons
bins (numpy.ndarray or IntervalIndex): returns the computed bins</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.format_for_ann">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">format_for_ann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.format_for_ann" title="Link to this definition">¶</a></dt>
<dd><p>Converts the multi-index DataFrame into input-output format for training a neural network.</p>
<p>Ensures that each row represents one spatial bin (with trial &amp; corridor info),
and columns represent neuronal activity.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>df (DataFrame): Multi-index DataFrame with (neuron, trial, corridor, Y_bin) indices.</p>
</dd>
<dt>Returns:</dt><dd><p>X (ndarray): Feature matrix where each row is a neuronal activity vector (neurons as columns).
y (tuple): Tuple of target labels (bins, corridors).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.load_anatomy">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">load_anatomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.load_anatomy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.load_data">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.load_data" title="Link to this definition">¶</a></dt>
<dd><p>Load neuronal activity and behavioral data from a given directory.</p>
<p>This function searches the specified directory for files ending in
‘<a href="#id1"><span class="problematic" id="id2">*</span></a>dff.pkl’ and ‘<a href="#id3"><span class="problematic" id="id4">*</span></a>behavior.pkl’, loads them as pandas DataFrames, 
and returns them.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>file_path (Path): Path to the directory containing the .pkl files.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: A tuple containing:</dt><dd><ul class="simple">
<li><p>dff (pd.DataFrame): DataFrame with neuronal activity (e.g., ΔF/F traces).</p></li>
<li><p>behavior (pd.DataFrame): DataFrame with behavioral data (e.g., positions, timestamps).</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.place_field_size">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">place_field_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_activity_mtx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chamber_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.place_field_size" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the place fields of bona fide place cells and returns their center of mass as well as their size.</p>
<dl class="simple">
<dt>Parameters: </dt><dd><p>avg_activity_mtx (DataFrame): Average activity in each spatial bin (MultiIndex: Neuron, Corridor).
neuron_ID (array): List of bona fide place cells to be used for indexing.
n_bins (int): Number of spatial bins (default: 30).
chamber_size (int): Size of the chamber in VR units (default: 150).</p>
</dd>
<dt>Returns:</dt><dd><p>pf_list (list of dicts): List of dictionaries with the size and center of mass of the place fields for each neuron.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.plot_neurons">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">plot_neurons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.plot_neurons" title="Link to this definition">¶</a></dt>
<dd><p>Plots the spatial specificity of bona fide place cells in the anatomical context, with three subplots:
1. Spatial specificity
2. Specificity Z-score
3. Population Z-score</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>file_path (Path): path to the folder containing all files for a given dataset.
neuron_index (array): list of indices for place cells.
spec_df (DataFrame): DataFrame with columns “spatial_specificity”, “specificity_zscore”, and “population_zscore”.
save_figure (boolean): Whether the figure should just be printed or also saved.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.pop_z_score">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">pop_z_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spatial_spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.pop_z_score" title="Link to this definition">¶</a></dt>
<dd><p>Compute the population-wide z-score for a spatial tuning curve.</p>
<p>This function normalizes a pandas Series by subtracting the mean 
and dividing by the standard deviation across the entire population.
If the standard deviation is zero, returns NaNs to avoid division by zero.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>spatial_spec (pd.Series): A Series representing spatial tuning </dt><dd><p>for a single neuron or condition.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>pd.Series: Z-scored values of the input Series. If the standard </dt><dd><p>deviation is zero, returns a Series of NaNs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.proximity_weighted_accuracy">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">proximity_weighted_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.proximity_weighted_accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Compute accuracy where predictions closer to the true bin get partial credit.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>y_true (array-like): True bin labels.
y_pred (array-like): Predicted bin labels.
max_distance (int): Maximum distance for partial credit.</p>
</dd>
<dt>Returns:</dt><dd><p>float: Proximity-weighted accuracy score.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.remove_interpolated_values">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">remove_interpolated_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.remove_interpolated_values" title="Link to this definition">¶</a></dt>
<dd><p>Cleans up interpolated X values by reassigning them to the nearest valid corridor value in time order.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>behavior (pandas.core.frame.DataFrame): contains X, Y columns with spatial information
n_corr (int): number of corridors to consider (defaults to 2)</p>
</dd>
<dt>Returns:</dt><dd><p>behavior (pandas.core.frame.DataFrame): cleaned behavior data with X values reassigned</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.spatial_info_calc">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">spatial_info_calc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">avg_activity_mtx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_per_bin</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.spatial_info_calc" title="Link to this definition">¶</a></dt>
<dd><p>Calculates the spatial information for each neuron based on the average activity in spatial bins and occupancy probability.</p>
<blockquote>
<div><dl class="simple">
<dt>Parameters:</dt><dd><p>avg_activity_mtx (pandas.core_frame.DataFrame): average activity in each spatial bin (MultiIndex: Neuron, Corridor).
time_per_bin (pandas.core_frame.DataFrame): time spent in each spatial bin (n_bins x n_corridors).</p>
</dd>
<dt>Returns:</dt><dd><p>spatial_info (pandas.Series): spatial information for each neuron, indexed by neuron ID.
spatial_spec (pandas.Series): spatial specificity for each neuron, indexed by neuron ID.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.spec_z_score">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">spec_z_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_permut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.spec_z_score" title="Link to this definition">¶</a></dt>
<dd><p>Calculates specificity z-score by circularly permutating activity &amp; behavioral data. From this shifted data,
a null distribution of specificity scores is computed. The specificity z-score is then calculated by subtracting
the mean of this distribution and dividing by its standard deviation.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>dff (DataFrame): dF/F activity data.
behavior (DataFrame): Behavioral data to be shifted.
sampling_rate (int): Sampling rate of the data (default: 30).
n_permut (int): Number of permutations (default: 1000).
n_bins (int): Number of spatial bins (default: 10).</p>
</dd>
<dt>Returns:</dt><dd><p>actual_spatial_spec (float): Actual specificity score.
shifted_spec (list): List of specificity scores from permuted data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.temporal_binning">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">temporal_binning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sec_per_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_moving</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.temporal_binning" title="Link to this definition">¶</a></dt>
<dd><p>Bins occupancy and activity data into temporal bins. 
Assumes that distinct corridors are characterized by X position and that a trial column exists in behavior</p>
<blockquote>
<div><dl class="simple">
<dt>Parameters:</dt><dd><p>dff (pandas.core.frame.DataFrame): df/f calcium imaging data (rows: time; columns: neurons)
behavior (pandas.core.frame.DataFrame): contains X, Y columns with spatial information, trial column and frdIn with tail vigor
sec_per_bin (int): how many seconds will be averaged into one bin, defaults to 1.
fps (int): recording speed in frames per second, defaults to 30
only_moving (bool): removing frames in which the animal is not moving, defaults to True.</p>
</dd>
<dt>Returns:</dt><dd><p>activity_data (np.ndarray): activity matrix after binning, columns = features, rows = bins
spatial_data (np.ndarray): average position of animal during each bin, columns = X, Y, rows = bins</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.trials_over_time">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">trials_over_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.trials_over_time" title="Link to this definition">¶</a></dt>
<dd><p>Returns a multi-index DataFrame containing the average activity per spatial bin 
per corridor per trial for each neuron.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>dff (DataFrame): dF/F activity data in timepoints (rows) x neurons (columns).
behavior (DataFrame): Behavioral data in timepoints (rows) x behavior (column).
n_bins (int): Number of spatial bins to divide the Y-position.</p>
</dd>
<dt>Returns:</dt><dd><p>DataFrame: Multi-index DataFrame with (neuron, trial, corridor, Y_bin) as indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spatialinfo.spatial_information.trials_over_time_figure">
<span class="sig-prename descclassname"><span class="pre">spatialinfo.spatial_information.</span></span><span class="sig-name descname"><span class="pre">trials_over_time_figure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_ID</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'magma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spatialinfo.spatial_information.trials_over_time_figure" title="Link to this definition">¶</a></dt>
<dd><p>For any given neuron ID, this plots the activity per spatial bin per corridor per trial in two heatmaps
with shared color scales and consistent x-axis (spatial bins).</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>neuron_ID (int): column number of neuron in dff.
dff (DataFrame): dF/F activity data in timepoints (rows) x neurons (columns).
behavior (DataFrame): Behavioral data in timepoints (rows) x behavior (column).
n_bins (int): number of spatial bins to plot (defaults to 10).
export_figure (boolean): defines whether plot should be saved (defaults to False).
cmap (str): defines colormap, defaults to “magma”.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-spatialinfo">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-spatialinfo" title="Link to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SpatialInformation</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">spatialinfo</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">spatialinfo package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">spatialinfo</a><ul>
      <li>Previous: <a href="modules.html" title="previous chapter">spatialinfo</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Lukas Anneser.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/spatialinfo.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>